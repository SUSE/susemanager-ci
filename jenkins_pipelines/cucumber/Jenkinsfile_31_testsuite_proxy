#!/usr/bin/env groovy
properties([
    buildDiscarder(logRotator(numToKeepStr: '100')),
    disableConcurrentBuilds(),
])

pipeline {
    agent { label 'sumaform-cucumber'  }
    triggers { cron('H 1-23/2 * * *')  }
    stages {
     stage('clone gitlab repo') {
        steps {
          echo 'clone testrunner repo'
          git url: 'https://gitlab.suse.de/galaxy/sumaform-test-runner.git'
       }
    }
    stage('Execute Testsuite') {
        steps {	
          echo 'Exectute 31 Testsuite'
          sh "cd ${env.WORKSPACE}"
          sh "export WITH_PROXY=\"true\" ./jenkins-runner.sh 31/VARS-full.sh"
          }
      }
    }
  post { 
        always { 
            cleanWs()
        }
    }
}
